//
   Created by Administrator on 2015/1/13.

doctype html
html
    head(lang="en")
        meta(charset="UTF-8")
        meta(name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no")
        link(href="/stylesheets/style.css" rel="stylesheet")

    body
        div#favourite_rooms
            div#favour_rooms_btn 我的收藏
            -if (favourite_rooms.length)
            div#favour_rooms_options
                each room_option,i in favourite_rooms
                    div.favour_room_option #{room_option}

        form
            div.room_input_desc 输入直播号:
            div(contenteditable="true" name="room")#room
            div.submit-div
                input(type="button" value="进入直播间")#enter-room-btn
    script(src="/javascripts/jquery.js")
    script.
        $("#enter-room-btn").on("click",function(){
            var room = encodeURI($("#room").html().trim());
            if(room.length > 20){
                alert("输入不合法");
            }else if(room.length == 0){
                alert("不能为空");
            }else{
                $.ajax({
                    url:'/we_account/knock_door',
                    type:"post",
                    data:{room:room},
                    success:function(results){
                        if(results && results.flag == 1){
                            window.location.href = '/we_account/open_door';
                        }else{
                            alert("对不起，您输入的门牌号有误");
                        }
                    },
                    error:function(err){
                        console.log(err);
                    }
                })
            }
        });